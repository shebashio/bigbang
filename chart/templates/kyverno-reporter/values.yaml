{{- $pkg := "kyvernoReporter" }}

{{- if (get .Values $pkg).enabled }}
{{- include "values-secret" (dict "root" $ "package" (get .Values $pkg) "name" ($pkg | kebabcase) "defaults" (include (printf "bigbang.defaults.%s" $pkg | kebabcase) .)) }}
{{- end }}

{{- define "bigbang.defaults.kyverno-reporter" -}}
{{- $istioEnabled := eq (include "istioEnabled" .) "true" }}

global:
  fullnameOverride: kyverno-reporter

{{- if $istioEnabled }}
istio:
  enabled: true
podAnnotations:
  {{ include "istioAnnotation" . }}
{{- end }}

networkPolicies:
  enabled: {{ .Values.networkPolicies.enabled }}
  istioNamespaceSelector:
  {{ include "istioNamespaceSelector" . | nindent 4 }}
  controlPlaneCidr: {{ .Values.networkPolicies.controlPlaneCidr }}

openshift: {{ .Values.openshift }}

upstream:
  image:
    pullPolicy: {{ .Values.imagePullPolicy }}
  imagePullSecrets:
  - name: private-registry
  ui:
    enabled: true
    image:
      pullPolicy: {{ .Values.imagePullPolicy }}
    imagePullSecrets:
    - name: private-registry
    {{- if $istioEnabled }}
    podAnnotations:
      {{ include "istioAnnotation" . }}
    {{- end }}

  {{- if .Values.monitoring.enabled }}
    # monitoring contains configurations related to monitoring
  monitoring:
    # -- Enables the Prometheus Operator integration
    enabled: true
    grafana:
      dashboards:
        enabled: true
        namespace: monitoring
  {{- end -}}
{{- end -}}
